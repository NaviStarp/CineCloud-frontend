<!-- Video Card Component -->
<div (click)="toggleEdit($event)" class="video-card group relative flex rounded-xl shadow-lg overflow-hidden transition-all duration-300 bg-neutral-800/90 border border-neutral-700/50 backdrop-blur-sm hover:bg-neutral-800 hover:scale-[1.01] hover:shadow-xl h-28">
  <!-- Thumbnail Container with Gradient Overlay -->
  <div class="thumbnail-container relative w-28 h-full flex-shrink-0 overflow-hidden">
    <img
      [src]="video.thumbnail || 'assets/placeholder-thumbnail.jpg'"
      alt="Video thumbnail"
      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
      (click)="playVideo($event)"
    >
    <!-- Gradient Overlay -->
    <div class="absolute inset-0 bg-gradient-to-r from-black/20 to-transparent"></div>
    
    <!-- Play Button Overlay -->
    <div
      class="play-button absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 group-hover:opacity-100 transition-all duration-300"
      [hidden]="isVideoPlaying"
      (click)="playVideo($event)"
    >
      <div class="w-12 h-12 rounded-full bg-white/90 flex items-center justify-center hover:bg-white transition-all duration-200 shadow-lg transform group-hover:scale-110">
        <fa-icon [icon]="faPlay" class="text-lg text-neutral-900 ml-1"></fa-icon>
      </div>
    </div>
  </div>
  
  <!-- Video Content Section -->
  <div class="video-content flex-grow flex flex-col justify-center px-6 py-3">
    <h3 class="video-title text-lg font-medium text-neutral-50  mb-1 overflow-clip sm:text-base md:text-lg  lg:text-xl">{{video.name}}  </h3>
      <div class="flex items-center">
      <span class="video-type text-sm text-neutral-400 px-2 py-0.5 rounded-full bg-neutral-700 mr-2">{{video.mediaType}}</span>
      <span class="video-series text-sm text-neutral-400" *ngIf="video.mediaType === 'series' && video.seriesName">
        {{video.seriesName}} S{{video.season}}:E{{video.chapter}}
      </span>
    </div>
  </div>
  
  <!-- Action Buttons -->
  <div class="video-actions flex items-center pr-5 space-x-3 min-w-2.5">
    <button 
      class="action-button text-neutral-400 hover:text-primary-400 p-2 transition-colors duration-200 rounded-full hover:bg-neutral-700/50" 
      (click)="toggleEdit($event)"
    >
      <fa-icon [icon]="faEdit" class="text-lg"></fa-icon>
    </button>
  </div>
</div>

<div 
  class="video-form bg-neutral-800 border border-neutral-700 text-neutral-50 rounded-xl p-6 mt-4 w-full shadow-lg transform transition-all duration-300"
  *ngIf="isEditing"
  [@slideInOut]
>
  <h2 class="text-xl font-bold mb-5 text-neutral-100">Editar Video</h2>
  <form (submit)="saveChanges($event)" class="space-y-5">
    <div class="form-group">
      <label for="title" class="block text-sm font-medium text-neutral-300 mb-2">Título</label>
      <input
        type="text"
        id="title"
        [(ngModel)]="video.name"
        name="title"
        class="w-full px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
        required
      >
    </div>
    
    <!-- Video Type Selector - Quick Toggle Buttons -->
    <div class="form-group">
      <label class="block text-sm font-medium text-neutral-300 mb-2">Tipo de Video</label>
      <div class="flex space-x-4">
        <button
          type="button"
          [ngClass]="{'bg-primary-600 text-white': video.mediaType === 'Pelicula', 'bg-neutral-700 text-neutral-300': video.mediaType !== 'Pelicula'}"
          class="px-5 py-2.5 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1"
          (click)="setVideoType('Pelicula')"
        >
          Película
        </button>
        <button
          type="button"
          [ngClass]="{'bg-primary-600 text-white': video.mediaType === 'series', 'bg-neutral-700 text-neutral-300': video.mediaType !== 'series'}"
          class="px-5 py-2.5 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1"
          (click)="setVideoType('series')"
        >
          Serie
        </button>
      </div>
    </div>

    <!-- Series Section - Only shown when type is 'series' -->
    <div *ngIf="video.mediaType === 'series'" class="space-y-5">
      <div class="form-group">
        <label for="series" class="block text-sm font-medium text-neutral-300 mb-2">Serie</label>
        <div class="flex space-x-2">
          <select
            id="series"
            [(ngModel)]="video.seriesId"
            name="series"
            class="flex-1 px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
            (change)="onSeriesChange($event)"
          >
            <option [value]="null" disabled selected>Selecciona una serie</option>
            <option *ngFor="let series of seriesList" [value]="series.id">{{series.titulo}}</option>
            <option [value]="'new'">-- Crear nueva serie --</option>
          </select>
          <button
            type="button"
            class="px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg hover:bg-neutral-600 focus:outline-none focus:ring-2 focus:ring-primary-500 transition-all duration-200"
            (click)="openCreateSeriesModal()"
          >
            <fa-icon [icon]="faPlus" class="text-lg"></fa-icon>
          </button>
        </div>
      </div>


      <!-- Create New Series Modal -->
      <div *ngIf="isCreatingNewSeries" class="mt-4 p-4 bg-neutral-700 rounded-lg border border-neutral-600">
        <h3 class="text-lg font-medium text-neutral-200 mb-3">Crear Nueva Serie</h3>
        <div class="form-group mb-4">
          <label for="newSeriesName" class="block text-sm font-medium text-neutral-300 mb-2">Nombre de la Serie</label>
          <input
            type="text"
            id="newSeriesName"
            [(ngModel)]="newSeries.name"
            name="newSeriesName"
            class="w-full px-4 py-3 bg-neutral-600 border border-neutral-500 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
            required
          >
        </div>
        <div class="form-group mb-4">
          <label for="newSeriesDescription" class="block text-sm font-medium text-neutral-300 mb-2">Descripción</label>
          <textarea
            id="newSeriesDescription"
            [(ngModel)]="newSeries.description"
            name="newSeriesDescription"
            class="w-full px-4 py-3 bg-neutral-600 border border-neutral-500 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 min-h-24 resize-none"
          ></textarea>
        </div>
        <div class="form-group mb-4">
          <label for="newSeriesGenre" class="block text-sm font-medium text-neutral-300 mb-2">Categoria</label>
          <select
            id="newSeriesGenre"
            [(ngModel)]="newSeries.category"
            name="newSeriesGenre"
            class="w-full px-4 py-3 bg-neutral-600 border border-neutral-500 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
          >
            <option value="" disabled selected>Selecciona una categoría</option>
            <option *ngFor="let category of categories" [value]="category">{{category}}</option>
          </select>
          </div>
        <div class="form-group mb-4">
          <label for="newSeriesReleaseDate" class="block text-sm font-medium text-neutral-300 mb-2">Fecha de Lanzamiento</label>
          <input
            type="date"
            id="newSeriesReleaseDate"
            [(ngModel)]="newSeries.releaseDate"
            name="newSeriesReleaseDate"
            class="w-full px-4 py-3 bg-neutral-600 border border-neutral-500 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
          >
        </div>
        
        <div class="flex justify-end space-x-3">
          <button
            type="button"
            class="px-4 py-2 border border-neutral-500 text-neutral-200 rounded-lg hover:bg-neutral-600 transition-colors duration-200"
            (click)="cancelCreateSeries()"
          >
            Cancelar
          </button>
          <button
            type="button"
            class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200"
            (click)="saveNewSeries()"
          >
            Guardar Serie
          </button>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div class="form-group">
          <label for="season" class="block text-sm font-medium text-neutral-300 mb-2">Temporada</label>
          <input
            type="number"
            id="season"
            [(ngModel)]="video.season"
            name="season"
            class="w-full px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
            min="1"
          >
        </div>
        <div class="form-group">
          <label for="chapter" class="block text-sm font-medium text-neutral-300 mb-2">Capítulo</label>
          <input
            type="number"
            id="chapter"
            [(ngModel)]="video.chapter"
            name="chapter"
            class="w-full px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
            min="1"
          >
        </div>
      </div>
    </div>
    
    <div class="form-group">
      <label for="description" class="block text-sm font-medium text-neutral-300 mb-2">Descripción</label>
      <textarea
        id="description"
        [(ngModel)]="video.description"
        name="description"
        class="w-full px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 min-h-32 resize-none"
      ></textarea>
    </div>
    <div class="form-group">
      <label for="release-date" class="block text-sm font-medium text-neutral-300 mb-2">Fecha de Lanzamiento</label>
      <input
        type="date"
        id="release-date"
        [(ngModel)]="video.releaseDate"
        name="release-date"
        class="w-full px-4 py-3 bg-neutral-700 border border-neutral-600 text-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
      >
    </div>
    <div class="flex justify-end space-x-4 pt-2">
      <button
        type="button"
        class="px-5 py-2.5 border border-neutral-600 text-neutral-200 rounded-lg hover:bg-neutral-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-neutral-500"
        (click)="toggleEdit($event)"
      >
        Cancelar
      </button>
      <button
        type="submit"
        class="px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 shadow-md hover:shadow-lg"
      >
        Guardar
      </button>
    </div>
  </form>
</div>

  <!-- Fullscreen Video Player Modal -->
  <div 
  class="video-player-container fixed inset-0 bg-black/95 backdrop-blur-lg flex items-center justify-center z-[99999]"
  *ngIf="isVideoPlaying" 
  (click)="$event.stopPropagation()"
>
  <div class="relative w-full max-w-[90%] h-full max-h-[90%] flex items-center justify-center">
    <!-- Close Button -->
    <button 
      class="relative left-5 text-white/80 hover:text-white p-2 rounded-full hover:bg-white/10 transition-colors z-[100000]"
      (click)="closeVideo($event)"
    >
      <fa-icon [icon]="faTimes" class="text-xl"></fa-icon>
    </button>
    
   <!-- Video Player -->
   <video #videoPlayer class="w-full h-full object-contain" controls autoplay>
    <source [src]="videoUrl" type="video/mp4">
    Tu navegador no soporta el elemento de video.
  </video>
  </div>
</div>